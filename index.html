<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Capialitas Jaz ‚Äî Men√∫</title>
<style>
  :root{
    --bg:#fff6ee;
    --card:#ffffff;
    --brand:#e23c3c;     /* rojo */
    --accent:#f49c24;    /* naranja */
    --ink:#2b2b2b;
    --muted:#6b7280;
    --ring:#ffd2c6;
    --chip:#f5e8dc;      /* crema marr√≥n */
    --brown:#8b5e3c;     /* marr√≥n para casillas */
  }
  *{box-sizing:border-box}
  body{
    margin:0;background:var(--bg);color:var(--ink);
    font-family: system-ui,-apple-system,"Segoe UI",Roboto,Arial,"Noto Sans","Helvetica Neue",sans-serif;
  }

  /* App bar */
  .appbar{position:sticky;top:0;z-index:20;background:linear-gradient(180deg,#ffe9db,transparent);border-bottom:1px solid #f8d3c7}
  .appbar__inner{max-width:1100px;margin:auto;display:flex;align-items:center;gap:12px;padding:12px 16px}
  .brand h1{margin:0;font-size:26px;line-height:1;font-weight:900;color:var(--brand)}
  .brand small{color:#c27767;font-weight:600}

  .wrap{max-width:1100px;margin:auto;padding:16px}
  .grid{display:grid;gap:18px;grid-template-columns:1.25fr .95fr}
  @media (max-width:940px){.grid{grid-template-columns:1fr}}

  .card{background:var(--card);border:1px solid #f5d6cd;border-radius:16px;box-shadow:0 10px 28px rgba(0,0,0,.06)}
  .card__hd{padding:14px 18px;border-bottom:1px solid #f5d6cd}
  .card__hd h2{margin:0;color:var(--accent);font-size:22px}
  .card__bd{padding:14px 18px}

  .title{font-weight:900;color:#e24a3f;margin:4px 0 10px}

  /* Men√∫ filas */
  .row{
    display:grid;grid-template-columns:1fr auto auto;gap:10px;align-items:center;
    padding:10px 0;border-top:1px solid #ffe0d9;
  }
  .row:first-child{border-top:0}
  .price{font-weight:800}
  .qty{width:78px}

  .btn{background:var(--brand);color:#fff;border:0;border-radius:12px;padding:9px 14px;font-weight:800;cursor:pointer}
  .btn:active{transform:scale(.98)}

  /* Chips y casillas en marr√≥n */
  .chips{display:flex;flex-wrap:wrap;gap:8px}
  .chip{
    display:inline-flex;align-items:center;gap:8px;
    padding:8px 10px;border-radius:12px;background:var(--chip);
    border:1px solid #e7d2c3;color:#5b3e2a;
  }
  .chip input{accent-color:var(--brown);transform:translateY(1px)}

  .muted{color:var(--muted);font-size:13px}

  /* Carrito visual */
  .cart-empty{color:var(--muted)}
  .cart-grid{display:flex;flex-direction:column;gap:10px}
  .ci{
    display:grid;grid-template-columns:auto 1fr auto;gap:10px;align-items:center;
    padding:10px;border:1px dashed #f1c9bf;border-radius:12px;background:#fffdfb;
  }
  .ci__img{width:46px;height:46px;border-radius:12px;display:grid;place-items:center;background:#fff3e6;border:1px solid #ffe0c9;font-size:22px}
  .ci__name{font-weight:700}
  .ci__sub{font-size:12px;color:var(--muted)}
  .mini{display:flex;align-items:center;gap:6px}
  .iconbtn{width:28px;height:28px;border-radius:8px;border:1px solid #ffd4c8;background:#fff;cursor:pointer}
  .tot{display:flex;justify-content:space-between;font-weight:800;padding-top:10px}

  /* Formulario */
  .f{display:flex;flex-direction:column;gap:10px}
  .f input,.f select,.f textarea{width:100%;padding:10px 12px;border:1px solid #f2cfca;border-radius:10px;outline:none}
  .help{font-size:12px;color:#b85c4f}
  .warn{font-size:13px;color:#b10000;background:#ffe6e6;border:1px solid #ffcccc;padding:8px 10px;border-radius:8px}

  .cta{margin-top:12px;width:100%}
</style>
</head>
<body>

<header class="appbar">
  <div class="appbar__inner">
    <div class="brand">
      <h1>Capialitas Jaz</h1>
      <small>Alitas con amor, cuidado y dedicaci√≥n</small>
    </div>
  </div>
</header>

<main class="wrap grid">
  <!-- MEN√ö -->
  <section class="card" id="menuCard">
    <div class="card__hd"><h2>Men√∫</h2></div>
    <div class="card__bd" id="menu"></div>
  </section>

  <!-- CARRITO + FORM -->
  <aside class="card">
    <div class="card__hd"><h2>Tu pedido</h2></div>
    <div class="card__bd">
      <div id="cart"></div>
      <div class="tot"><span>Subtotal</span><span id="subtotal">$0.00</span></div>

      <h3 class="title">Datos de entrega</h3>
      <div class="f">
        <input id="nombre" placeholder="Nombre de quien recibe">
        <input id="direccion" placeholder="Direcci√≥n (calle, n√∫mero, colonia)">
        <select id="zona">
          <option value="">Selecciona zona</option>
          <option>Ju√°rez</option><option>Cadete Molino</option><option>Plan de Ayala</option>
          <option>San Antonio Zomeyucan</option><option>Bonfil</option><option>San Bartolo</option>
          <option>Martires del Rio Blanco</option><option>Otra</option>
        </select>
        <div id="zonaWarn" class="warn" style="display:none">‚ö† Posible fuera de zona</div>

        <input id="cuando" type="datetime-local">
        <div class="help">Horario: <b>Viernes, S√°bado y Domingo, 4:00‚Äì9:00 p.m.</b></div>
        <div id="horaWarn" class="warn" style="display:none">‚õî Fuera de horario de servicio. Selecciona una fecha y hora v√°lidas.</div>

        <h4 class="title" style="margin-top:8px">M√©todo de pago</h4>
        <label class="chip"><input type="radio" name="pago" value="transferencia" checked> Transferencia</label>
        <label class="chip"><input type="radio" name="pago" value="mitad"> Mitad transferencia / mitad efectivo</label>

        <textarea id="notas" rows="3" placeholder="Notas (sin pan, extra picante, referencia, etc.)"></textarea>
        <button class="btn cta" id="whatsBtn">Enviar por WhatsApp</button>
      </div>
    </div>
  </aside>
</main>

<script>
/* ================== CONFIG ================== */
const SELLER_WA = "525636364089";
const money = n => `$${Number(n).toFixed(2)}`;

/* Servicio: Vie (5), S√°b(6), Dom(0) ‚Äî 16:00‚Äì21:00 */
function isServiceOpen(date){
  if(!date) return false;
  const d = new Date(date);
  const day = d.getDay(); // 0..6
  const h = d.getHours();
  const isFSD = (day===5 || day===6 || day===0);
  return isFSD && h>=16 && h<21;
}

/* ================== MEN√ö ================== */
const ING_BASE = ["Mayonesa","Catsup","Mostaza","Lechuga","Chiles jalape√±o","Jitomate","Cebolla caramelizada","Queso Chihuahua"];
const SABORES = ["Tamarindo","BBQ","Parmesano","Mango Habanero"];
const ALITAS_BASE = ["Lechuga","Zanahoria","Pepino","Jugo Maggi","Salsa inglesa","Aderezo Ranch"];

const MENU = [
  {cat:"Hamburguesas", nombre:"üçî Hamburguesa sencilla", precio:65, toppings:ING_BASE, img:"üçî"},
  {cat:"Hamburguesas", nombre:"üçî Hamburguesa doble carne", precio:95, toppings:ING_BASE.filter(i=>i!=="Queso Chihuahua"), img:"üçî"},
  {cat:"Alitas", nombre:"üçó Alitas 7 pz", precio:75, toppings:ALITAS_BASE, sabores:SABORES, mitad:true, img:"üçó"},
  {cat:"Alitas", nombre:"üçó Alitas 12 pz", precio:115, toppings:ALITAS_BASE, sabores:SABORES, mitad:true, img:"üçó"},
  {cat:"Alitas", nombre:"üçó Alitas 24 pz", precio:210, toppings:ALITAS_BASE, sabores:SABORES, mitad:true, img:"üçó"},
  {cat:"Extras", nombre:"Salsa mango habanero", precio:10, extra:true, img:"üå∂Ô∏è"},
  {cat:"Extras", nombre:"Salsa tamarindo", precio:10, extra:true, img:"ü•£"},
  {cat:"Extras", nombre:"Crema parmesano", precio:10, extra:true, img:"üßÄ"},
  {cat:"Extras", nombre:"Salsa BBQ", precio:10, extra:true, img:"ü•´"},
  {cat:"Extras", nombre:"Aderezo ranch", precio:10, extra:true, img:"ü•õ"},
  {cat:"Producto de la semana", nombre:"üî• Flamin'Hot + Papas", precio:115,
    toppings:["Mayonesa con chipotle","Queso Chihuahua","Catsup","Lechuga","Mostaza","Cebolla caramelizada","Tocino","Salsa de queso","Cheetos Flaming Hot"], img:"üî•"},
  {cat:"Producto de la semana", nombre:"üß° Doriburguer Crunch", precio:115,
    toppings:["Mayonesa","Catsup","Mostaza","Lechuga","Chiles jalape√±o","Cebolla caramelizada","Queso Oaxaca","Guacamole","Aderezo Ranch","Doritos Nacho"], img:"üß°"},
];

let cart=[];

/* ================== RENDER MEN√ö ================== */
function chip(label, id){ return `<label class="chip"><input type="checkbox" id="${id}" value="${label}"> ${label}</label>` }

function renderMenu(){
  const $menu = document.getElementById('menu');
  $menu.innerHTML = "";

  const cats = [...new Set(MENU.map(i=>i.cat))];
  cats.forEach(cat=>{
    const block = document.createElement('div');
    block.className="block";
    block.innerHTML = `<h3 class="title">${cat}</h3>`;
    const items = MENU.filter(i=>i.cat===cat);

    items.forEach(item=>{
      const idx = MENU.indexOf(item);
      const row = document.createElement('div'); row.className="row";

      const left = document.createElement('div');
      left.innerHTML = `
        <div style="font-weight:800">${item.nombre}</div>
        ${item.toppings?.length ? `<div class="muted">Elige ingredientes</div>
          <div class="chips">${item.toppings.map((t,i)=>chip(t,`t_${idx}_${i}`)).join("")}</div>`:""}
        ${item.sabores ? `
          <div class="muted" style="margin-top:6px">Sabor(es)</div>
          <div class="chips">
            ${item.sabores.map((s,i)=>chip(s,`s_${idx}_${i}`)).join("")}
          </div>
          ${item.mitad ? `<div class="chips" style="margin-top:6px">
             <label class="chip"><input type="checkbox" id="half_${idx}"> Mitad y mitad (elige 2)</label>
          </div>`:""}
        `:""}
      `;

      const price = document.createElement('div');
      price.className="price";
      price.textContent = money(item.precio);

      const cta = document.createElement('div');
      cta.innerHTML = `
        <input class="qty" id="q_${idx}" type="number" min="1" value="1">
        <button class="btn" id="add_${idx}">Agregar</button>
      `;

      row.appendChild(left); row.appendChild(price); row.appendChild(cta); block.appendChild(row);

      setTimeout(()=>{
        document.getElementById(`add_${idx}`).onclick = ()=>{
          const qty = Math.max(1, parseInt(document.getElementById(`q_${idx}`).value||"1",10));
          const toppings = (item.toppings||[]).filter((t,i)=>document.getElementById(`t_${idx}_${i}`)?.checked);
          let sabores = [];
          if(item.sabores){
            sabores = item.sabores.filter((s,i)=>document.getElementById(`s_${idx}_${i}`)?.checked);
            const half = document.getElementById(`half_${idx}`)?.checked;
            if(half){
              sabores = sabores.slice(0,2);
              if(sabores.length===1) sabores.push("(mitad cl√°sica)");
              if(sabores.length===0) sabores = ["Mitad 1","Mitad 2"];
            }
          }
          cart.push({nombre:item.nombre, precio:item.precio, qty, toppings, sabores, extra:item.extra===true, img:item.img||"üçΩÔ∏è"});
          renderCart();
          window.scrollTo({top:0,behavior:'smooth'});
        };
      });
    });
    $menu.appendChild(block);
  });
}

/* ================== CARRITO VISUAL ================== */
function renderCart(){
  const $c = document.getElementById('cart');
  $c.innerHTML = "";
  let total = 0;

  if(cart.length===0){
    $c.innerHTML = `<p class="cart-empty">Tu carrito est√° vac√≠o.</p>`;
    document.getElementById('subtotal').textContent = money(0);
    return;
  }

  const grid = document.createElement('div');
  grid.className = "cart-grid";

  cart.forEach((it, i)=>{
    total += it.precio * it.qty;
    const det = [];
    if(it.toppings?.length) det.push(it.toppings.join(", "));
    if(it.sabores?.length)  det.push("Sabores: " + it.sabores.join(" / "));

    const row = document.createElement('div');
    row.className = "ci";
    row.innerHTML = `
      <div class="ci__img">${it.img||"üçΩÔ∏è"}</div>
      <div>
        <div class="ci__name">${it.nombre}</div>
        ${det.length? `<div class="ci__sub">${det.join(" ¬∑ ")}</div>`:""}
      </div>
      <div class="mini">
        <button class="iconbtn" onclick="chg(${i},-1)">‚Äì</button>
        <span><b>${it.qty}</b></span>
        <button class="iconbtn" onclick="chg(${i},+1)">+</button>
        <button class="iconbtn" onclick="delItem(${i})">‚úï</button>
        <b>${money(it.precio*it.qty)}</b>
      </div>
    `;
    grid.appendChild(row);
  });

  $c.appendChild(grid);
  document.getElementById('subtotal').textContent = money(total);
}
function chg(i, d){ cart[i].qty = Math.max(1, cart[i].qty + d); renderCart(); }
function delItem(i){ cart.splice(i,1); renderCart(); }

/* ================== VALIDACI√ìN HORARIO + WHATSAPP ================== */
function toWhats(){
  if(cart.length===0){ alert("Tu carrito est√° vac√≠o"); return; }

  const nombre = document.getElementById('nombre').value.trim();
  const direccion = document.getElementById('direccion').value.trim();
  const zona = document.getElementById('zona').value;
  const cuando = document.getElementById('cuando').value;
  const pago = [...document.querySelectorAll('input[name="pago"]')].find(r=>r.checked)?.value || "transferencia";
  const notas = document.getElementById('notas').value.trim();

  if(!nombre || !direccion || !zona){ alert("Completa nombre, direcci√≥n y zona."); return; }
  document.getElementById('zonaWarn').style.display = (zona==="Otra") ? "block" : "none";

  // Debe seleccionar fecha/hora y debe estar dentro de horario ‚Äî si no, bloquear
  const horaWarn = document.getElementById('horaWarn');
  if(!cuando){ horaWarn.style.display="block"; return; }
  const d = new Date(cuando);
  if(!isServiceOpen(d)){ horaWarn.style.display="block"; return; }
  horaWarn.style.display="none";

  // Mensaje
  const lines = [];
  lines.push("Nuevo pedido ‚Äî Capialitas Jaz");
  lines.push("‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ");
  cart.forEach((it, idx)=>{
    lines.push(`${idx+1}. ${it.qty}√ó ${it.nombre.replace(/^üçî |^üçó |^üî• |^üß° /,"")} ‚Äî ${money(it.precio*it.qty)}`);
    if(it.toppings?.length) lines.push(`   ¬∑ ${it.toppings.join(", ")}`);
    if(it.sabores?.length)  lines.push(`   ¬∑ ${it.sabores.join(" / ")}`);
  });
  const total = cart.reduce((s,i)=>s+i.precio*i.qty,0);
  lines.push("‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ");
  lines.push(`Subtotal: ${money(total)}`);
  lines.push("");
  lines.push(`Cliente: ${nombre}`);
  lines.push(`Direcci√≥n: ${direccion}`);
  lines.push(`Zona: ${zona}${zona==="Otra"?" (posible fuera de zona)":"":""}`);
  lines.push(`Entrega: ${d.toLocaleString("es-MX")}`);
  if(notas) lines.push(`Notas: ${notas}`);
  lines.push("");
  lines.push(`Pago: ${pago==="transferencia" ? "Transferencia" : "Mitad transferencia / mitad efectivo"}`);

  const text = encodeURIComponent(lines.join("\n"));
  window.open(`https://wa.me/${SELLER_WA}?text=${text}`, "_blank");
}

/* ================== INIT ================== */
renderMenu();
renderCart();

// avisos UX live al cambiar fecha
document.getElementById('cuando').addEventListener('change', (e)=>{
  const v = e.target.value;
  const ok = v && isServiceOpen(new Date(v));
  document.getElementById('horaWarn').style.display = ok ? "none" : "block";
});

document.getElementById('whatsBtn').onclick = toWhats;
</script>
</body>
</html>
